<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <!-- 1. æ ¸å¿ƒé€‚é…ï¼šè®¾ç½®è§†å£ï¼Œç¡®ä¿ç§»åŠ¨ç«¯æ¸²æŸ“æ¯”ä¾‹æ­£ç¡® -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>å•å¼ æµ·æŠ¥é…è‰²ç”Ÿæˆå™¨</title>
    <style>
        :root {
            --c1: #BDEBC7;
            --c2: #C5F1F1;
            --c3: #C3CEEF;
            --c4: #D9D1EB;
            --poster-bg: #FDF8F0; 
            --title-color: #143068;
        }

        /* å…¨å±€ç›’æ¨¡å‹ï¼Œé˜²æ­¢paddingæ’‘ç ´å¸ƒå±€ */
        * {
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background-color: #2c2c2c;
            display: flex;
            justify-content: center;
            align-items: center; /* ç”µè„‘ç«¯å‚ç›´å±…ä¸­ */
            min-height: 100vh;
            margin: 0;
            color: #333;
            padding: 20px; /* è¾¹ç¼˜ç•™ç™½ */
        }

        .workspace {
            display: flex;
            gap: 40px;
            align-items: flex-start;
            flex-wrap: wrap;
            justify-content: center;
            width: 100%;
            max-width: 1200px;
        }

        /* --- å·¦ä¾§æ§åˆ¶é¢æ¿ --- */
        .controls {
            background: #fff;
            padding: 25px;
            border-radius: 16px;
            width: 300px; /* ç•¥å¾®åŠ å®½ */
            flex-shrink: 0;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        .controls h3 { margin-top: 0; margin-bottom: 20px; color: #333; font-size: 18px; }
        
        .section-title {
            font-size: 12px; font-weight: bold; color: #888; 
            margin-top: 20px; margin-bottom: 10px; text-transform: uppercase; letter-spacing: 1px;
        }

        .color-input-group {
            display: flex;
            align-items: center;
            margin-bottom: 12px;
            background: #f8f9fa;
            padding: 6px 10px;
            border-radius: 8px;
            border: 1px solid #eee;
            transition: border-color 0.2s;
        }
        .color-input-group:hover { border-color: #ccc; }
        .color-input-group label { width: 20px; font-weight: bold; color: #999; font-size: 14px; }
        
        .color-input-group input[type="color"] {
            border: none; width: 30px; height: 30px; cursor: pointer; background: none; margin-right: 10px; padding: 0;
        }
        
        .color-input-group input[type="text"] {
            border: none; background: transparent; width: 100%; 
            font-family: 'Monaco', monospace; font-size: 13px; color: #555;
            outline: none; text-transform: uppercase; cursor: copy;
        }
        
        select {
            width: 100%; padding: 10px; border: 1px solid #ddd; 
            border-radius: 8px; font-size: 14px; margin-bottom: 10px;
            background-color: #fff; outline: none;
        }
        
        /* é€šç”¨æŒ‰é’® */
        button {
            width: 100%; padding: 12px; border: none; 
            border-radius: 8px; font-weight: 600; cursor: pointer; margin-top: 8px;
            transition: 0.2s; font-size: 14px;
        }
        
        .btn-generate { background: #3b82f6; color: white; }
        .btn-generate:active { transform: scale(0.98); }
        .btn-generate:hover { background: #2563eb; }
        
        .btn-download { background: #e5e7eb; color: #374151; margin-top: 20px; }

        /* æ–‡å­—é“¾æ¥æŒ‰é’® (ç”¨äºå¤åˆ¶æ•´ç»„) */
        .btn-text-action {
            display: block;
            text-align: right;
            font-size: 12px;
            color: #3b82f6;
            cursor: pointer;
            margin-top: 10px; /* å¢åŠ ä¸€ç‚¹é—´è· */
            text-decoration: none;
            font-weight: 500;
            padding: 5px 0; /* å¢åŠ ç‚¹å‡»åŒºåŸŸ */
        }
        .btn-text-action:hover { text-decoration: underline; color: #2563eb; }

        /* --- å³ä¾§æµ·æŠ¥åŒºåŸŸ (å“åº”å¼æ”¹é€ ) --- */
        .poster-card {
            width: 100%;
            max-width: 500px; /* ç”µè„‘ç«¯æœ€å¤§å®½åº¦ */
            /* ä½¿ç”¨ aspect-ratio ä¿æŒé•¿æ–¹å½¢æ¯”ä¾‹ï¼Œä¸å†å†™æ­» height */
            aspect-ratio: 5/6;
            min-height: 200px; /* ç”µè„‘ç«¯ä¿æŒé«˜åº¦ */
            
            background-color: var(--poster-bg);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            box-shadow: 0 20px 60px rgba(0,0,0,0.4);
            position: relative;
            background-image: linear-gradient(rgba(255,255,255,0.5), rgba(255,255,255,0.5)); 
            padding: 40px 0;
        }

        /* æ ¸å¿ƒå¸ƒå±€å®¹å™¨ï¼šæ§åˆ¶å†…å®¹å æµ·æŠ¥å®½åº¦çš„ 80%ï¼Œå®ç°è‡ªé€‚åº” */
        .poster-content-wrapper {
            width: 80%;
            display: flex;
            flex-direction: column;
        }

        .poster-header {
            text-align: center;
            width: 100%;
            margin-bottom: 30px;
            display: flex;
            flex-direction: column;
        }

        .header-title {
            /* å­—ä½“æµä½“ç¼©æ”¾ï¼šæœ€å°32pxï¼Œæœ€å¤§48px */
            font-size: clamp(32px, 8vw, 48px);
            font-weight: 800; color: var(--title-color);
            text-transform: uppercase; letter-spacing: 2px;
            line-height: 1; margin-bottom: 0px;
            word-break: break-word;
        }

        .header-meta {
            display: flex;
            flex-direction: column;
            align-items: flex-end; 
            margin-top: 5px;
            width: 100%;
        }

        .serial-number {
            font-family: 'Monaco', 'Courier New', monospace;
            font-size: 12px;
            font-weight: 600;
            color: #999;
            letter-spacing: 1px;
            margin-bottom: 5px;
            cursor: pointer;
            transition: color 0.2s;
        }
        .serial-number:hover { color: #3b82f6; }
        .serial-number:active { transform: scale(0.95); }

        .separator-line {
            width: 100%; height: 2px; background-color: #e0e0e0; border-radius: 2px;
        }

        /* è‰²å—åŒºåŸŸè‡ªé€‚åº” */
        .palette-container { 
            display: flex; 
            gap: 4%; /* ä½¿ç”¨ç™¾åˆ†æ¯”é—´è· */
            width: 100%;
            justify-content: space-between;
        }

        .swatch-group {
            display: flex; flex-direction: column; align-items: center; 
            flex: 1; /* å¹³åˆ†å®½åº¦ */
            cursor: pointer; transition: transform 0.2s;
        }
        .swatch-group:hover { transform: translateY(-5px); }
        .swatch-group:active { transform: translateY(0); }

        .color-rect {
            width: 100%; 
            /* ä¿æŒè‰²å—é•¿å®½æ¯” */
            aspect-ratio: 0.35; 
            min-height: 140px; 
            margin-bottom: 20px; 
            box-shadow: 0 5px 15px rgba(0,0,0,0.08); 
            border-radius: 10px;
            transition: background-color 0.4s ease; 
        }
        
        .rect-1 { background-color: var(--c1); }
        .rect-2 { background-color: var(--c2); }
        .rect-3 { background-color: var(--c3); }
        .rect-4 { background-color: var(--c4); }

        .hex-label {
            font-size: clamp(10px, 3vw, 14px); /* å­—ä½“è‡ªé€‚åº” */
            font-weight: 600; color: #333;
            text-transform: uppercase; letter-spacing: 0.5px;
            font-family: 'Monaco', monospace;
            white-space: nowrap;
        }

        .watermark {
            margin-top: 40px; font-size: 14px; font-weight: 700;
            color: #4f4f4f; letter-spacing: 1px; font-family: sans-serif; opacity: 0.8;
        }

        /* --- ç§»åŠ¨ç«¯ä¸“ç”¨æ ·å¼ --- */
        @media screen and (max-width: 850px) {
            body {
                align-items: flex-start; /* é¡¶éƒ¨å¯¹é½ */
                padding: 15px;
                height: auto;
            }

            .workspace {
                flex-direction: column; /* ä¸Šä¸‹ç»“æ„ */
                align-items: center;
                gap: 20px;
            }

            .controls {
                width: 100%; /* é¢æ¿å æ»¡ */
                max-width: 500px;
            }

            .poster-card {
                width: 100%;
                min-height: auto; /* å–æ¶ˆå›ºå®šé«˜åº¦ */
                margin-bottom: 20px; /* åº•éƒ¨ç•™ç™½ï¼Œæ–¹ä¾¿æˆªå›¾ */
                box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            }
        }

        /* --- Toast --- */
        #toast {
            visibility: hidden; min-width: 200px; margin-left: -100px;
            background-color: rgba(30, 30, 30, 0.9); color: #fff;
            text-align: center; border-radius: 50px; padding: 12px;
            position: fixed; z-index: 100; left: 50%; bottom: 30px;
            font-size: 14px; box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            opacity: 0; transform: translateY(20px); transition: all 0.3s;
        }
        #toast.show { visibility: visible; opacity: 1; transform: translateY(0); }

    </style>
</head>
<body>

<div class="workspace">
    


    <!-- å³ä¾§æµ·æŠ¥åŒºåŸŸ -->
    <div class="poster-card" id="myPoster">
        
        <!-- ä½¿ç”¨ Wrapper åŒ…è£¹å†…å®¹å®ç°è‡ªé€‚åº”å¯¹é½ -->
        <div class="poster-content-wrapper">
            <!-- å¤´éƒ¨ -->
            <div class="poster-header">
                <div class="header-title" id="themeTitle">PASTEL</div>
                <div class="header-meta">
                    <!-- ä¿æŒç‚¹å‡»å¤åˆ¶æ‰€æœ‰é¢œè‰²çš„åŠŸèƒ½ -->
                    <span class="serial-number" id="serialNo" onclick="copyAllHex()" title="ç‚¹å‡»å¤åˆ¶æ‰€æœ‰é¢œè‰²">No.001</span>
                    <div class="separator-line"></div>
                </div>
            </div>
            
            <!-- è‰²å— -->
            <div class="palette-container">
                <div class="swatch-group" onclick="copyColorByIndex(1)">
                    <div class="color-rect rect-1"></div>
                    <div class="hex-label" id="label-1">BDEBC7</div>
                </div>
                <div class="swatch-group" onclick="copyColorByIndex(2)">
                    <div class="color-rect rect-2"></div>
                    <div class="hex-label" id="label-2">C5F1F1</div>
                </div>
                <div class="swatch-group" onclick="copyColorByIndex(3)">
                    <div class="color-rect rect-3"></div>
                    <div class="hex-label" id="label-3">C3CEEF</div>
                </div>
                <div class="swatch-group" onclick="copyColorByIndex(4)">
                    <div class="color-rect rect-4"></div>
                    <div class="hex-label" id="label-4">D9D1EB</div>
                </div>
            </div>
        </div>

        <div class="watermark">@Kaimana</div>
    </div>

        <!-- å·¦ä¾§æ§åˆ¶é¢æ¿ -->
    <div class="controls">
        <h3>ğŸ¨ é…è‰²å·¥ä½œå°</h3>
        
        <div class="section-title">æ™ºèƒ½ç”Ÿæˆ</div>
        <select id="themeSelect">
            <option value="pastel">é©¬å¡é¾™ (Pastel)</option>
            <option value="vibrant">å¤šå·´èƒº (Vibrant)</option>
            <option value="morandi">è«å…°è¿ª (Morandi)</option>
            <option value="natural">è‡ªç„¶é£æ™¯ (Natural)</option>
            <option value="forest">æ£®æ—ç‰©è¯­ (Forest)</option>
            <option value="ocean">æ·±æµ·å¹½è“ (Ocean)</option>

                <!-- === æ–°å¢ä»¥ä¸‹å››ä¸ªé€‰é¡¹ === -->
            <option value="retro">å¤å¤èƒ¶ç‰‡ (Retro)</option>
            <option value="tradition">ä¸œæ–¹é›…éŸµ (Tradition)</option>
        </select>
        <button class="btn-generate" onclick="generateNewPalette()">âœ¨ éšæœºç”Ÿæˆé…è‰²</button>

        <div class="section-title" style="margin-top: 25px;">å¾®è°ƒé¢œè‰² (ç‚¹å‡»ç¼–ç å¤åˆ¶)</div>
        
        <div class="color-input-group">
            <label>1</label>
            <input type="color" id="p1" value="#BDEBC7" oninput="updatePoster(1, this.value)">
            <input type="text" id="t1" value="#BDEBC7" readonly onclick="copyFromInput(this)">
        </div>
        
        <div class="color-input-group">
            <label>2</label>
            <input type="color" id="p2" value="#C5F1F1" oninput="updatePoster(2, this.value)">
            <input type="text" id="t2" value="#C5F1F1" readonly onclick="copyFromInput(this)">
        </div>

        <div class="color-input-group">
            <label>3</label>
            <input type="color" id="p3" value="#C3CEEF" oninput="updatePoster(3, this.value)">
            <input type="text" id="t3" value="#C3CEEF" readonly onclick="copyFromInput(this)">
        </div>

        <div class="color-input-group">
            <label>4</label>
            <input type="color" id="p4" value="#D9D1EB" oninput="updatePoster(4, this.value)">
            <input type="text" id="t4" value="#D9D1EB" readonly onclick="copyFromInput(this)">
        </div>

        <!-- å°å·§çš„å¤åˆ¶æ•´ç»„æŒ‰é’® -->
        <a class="btn-text-action" onclick="copyAllHex()">ğŸ“‹ å¤åˆ¶æ•´ç»„è‰²å€¼</a>

        <button class="btn-download" onclick="downloadPoster()">ğŸ“· ä¿å­˜æç¤º</button>
    </div>
</div>

<div id="toast">å·²å¤åˆ¶åˆ°å‰ªè´´æ¿</div>

<script>
    // æ•°å­¦å·¥å…·
    function rand(min, max) { return Math.floor(Math.random() * (max - min + 1)) + min; }

    function hslToHex(h, s, l) {
        l /= 100;
        const a = s * Math.min(l, 1 - l) / 100;
        const f = n => {
            const k = (n + h / 30) % 12;
            const color = l - a * Math.max(Math.min(k - 3, 9 - k, 1), -1);
            return Math.round(255 * color).toString(16).padStart(2, '0');
        };
        return `#${f(0)}${f(8)}${f(4)}`.toUpperCase();
    }

    // ç®—æ³•é€»è¾‘
    function generateGradientColors(count, options) {
        const { 
            baseHue = rand(0, 360), hueSpan = rand(60,75), sRange = [60, 85], lRange = [30, 80],
            hueDirection = Math.random() > 0.5 ? 1 : -1
        } = options;
        let hslColors = [];
        for (let i = 0; i < count; i++) {
            const progress = i / (count - 1);
            const h = (baseHue + (progress * hueSpan * hueDirection) + 360) % 360;
            const s = rand(sRange[0], sRange[1]);
            const lStart = lRange[0], lEnd = lRange[1];
            let l = lStart + (progress * (lEnd - lStart)) + rand(-5, 5); 
            hslColors.push({h, s, l});
        }
        if (Math.random() > 0.5) hslColors.reverse();
        hslColors.sort(() => Math.random() - 0.5)
        return hslColors.map(c => hslToHex(c.h, c.s, c.l));
    }

    function getColorsByTheme(theme) {
        const count = 4;
        let hslColors = [];

        if (theme === 'vibrant') {
            const baseHue = rand(0, 360);
            const endHue = (baseHue + 120 + rand(0, 120)) % 360;
            hslColors.push({h: baseHue, s: rand(80, 100), l: rand(50, 65)});
            for (let i = 1; i < count - 1; i++) {
                const ratio = i / (count - 1);
                let h = (baseHue + (endHue - baseHue) * ratio + 360) % 360; 
                hslColors.push({h: h, s: rand(85, 95), l: rand(55, 70)});
            }
            hslColors.push({h: endHue, s: rand(80, 100), l: rand(50, 65)});
            hslColors.sort(() => Math.random() - 0.5)
            return hslColors.map(c => hslToHex(c.h, c.s, c.l));
        }
        else if (theme === 'morandi') {
            const baseHue = rand(0, 360);
            for(let i=0; i<count; i++) {
                let h = (baseHue + (i * 45) + rand(-15,15)) % 360; 
                hslColors.push({h, s: rand(10, 30), l: rand(60, 75)});
            }
            hslColors.sort((a, b) => a.l - b.l);
            hslColors.sort(() => Math.random() - 0.5)
            return hslColors.map(c => hslToHex(c.h, c.s, c.l));
        }
        else if (theme === 'pastel') {
            const baseHue = rand(0, 360);
            for(let i=0; i<count; i++) {
                hslColors.push({h: (baseHue + i * rand(30, 60)) % 360, s: rand(40, 70), l: rand(82, 92)});
            }
            hslColors.sort(() => Math.random() - 0.5)
            return hslColors.map(c => hslToHex(c.h, c.s, c.l));
        }
        else if (theme === 'natural') {
            return generateGradientColors(4, { hueSpan: rand(40, 80), sRange: [50, 80], lRange: [30, 85] });
        }
        else if (theme === 'forest') {
            if (Math.random() > 0.3) return generateGradientColors(4, { baseHue: rand(90, 140), hueSpan: 30, sRange: [30, 60], lRange: [25, 80] });
            else return [hslToHex(rand(100,140), rand(40,60), rand(20,35)), hslToHex(rand(90,130), rand(40,60), rand(60,80)), hslToHex(rand(25,45), rand(40,60), rand(30,50)), hslToHex(rand(30,50), rand(10,30), rand(85,95))];
        }
        else if (theme === 'ocean') {
            //return generateGradientColors(4, { baseHue: rand(180, 240), hueSpan: 40, sRange: [50, 90], lRange: [15, 90] });
            // ç­–ç•¥ï¼šä¸ä½¿ç”¨è‡ªåŠ¨æ¸å˜ï¼Œæ‰‹åŠ¨æ„å»ºæœ‰å±‚æ¬¡çš„æµ·æ´‹
            const mainHue = rand(190, 240); // è“åˆ°æ·±è“
            
            return [
                hslToHex(mainHue, rand(80, 100), rand(10, 35)),       // 1. æ·±æ¸Šè‰²ï¼ˆææ·±ï¼‰
                hslToHex(mainHue + rand(-20, 20), rand(50, 70), rand(40, 60)), // 2. ä¸»æµ·è‰²ï¼ˆä¸­ç­‰ï¼‰
                hslToHex(rand(160, 190), rand(60, 90), rand(70, 85)), // 3. æµ…æ»©é’è‰²ï¼ˆåç»¿ï¼Œäº®ï¼‰
                Math.random() > 0.5 
                    ? hslToHex(rand(30, 50), rand(30, 60), rand(85, 95)) // 4a. æ²™æ»©è‰²ï¼ˆæš–è‰²å¯¹æ¯”ï¼‰
                    : hslToHex(mainHue, rand(10, 30), rand(90, 98))      // 4b. æµªèŠ±ç™½ï¼ˆæäº®ï¼‰
            ];
        }

    // é€»è¾‘ï¼šéšæœºåˆ‡æ¢ä¸‰ç§ç»å…¸ä¼ ç»Ÿé…è‰²æ¨¡å¼ï¼ˆæœ±çº¢é‡‘ã€é’èŠ±è“ã€æ°´å¢¨ç»¿ï¼‰
    else if (theme === 'tradition') {
        const style = Math.random();
        if (style < 0.33) { 
            // ä¸¹é›˜ (æœ±çº¢/é‡‘/é»‘/ç™½) - æ•…å®«é£
            return [
                hslToHex(rand(350, 360), rand(70, 85), rand(35, 45)), // å®«å¢™çº¢
                hslToHex(rand(40, 50), rand(70, 90), rand(60, 75)),   // ç‰ç’ƒé»„
                hslToHex(rand(0, 40), rand(5, 15), rand(90, 96)),     // å®£çº¸ç™½
                hslToHex(rand(0, 0), rand(0, 5), rand(15, 25))        // å¾½å¢¨é»‘
            ];
        } else if (style < 0.66) {
            // é›é’ (è“/ç™½/ç°) - é’èŠ±ç“·é£
            return [
                hslToHex(rand(210, 230), rand(60, 80), rand(25, 35)), // é›è“
                hslToHex(rand(190, 210), rand(30, 50), rand(60, 75)), // å½±é’
                hslToHex(rand(200, 220), rand(10, 20), rand(85, 95)), // æœˆç™½
                hslToHex(rand(200, 220), rand(20, 40), rand(40, 50))  // é»›è“
            ];
        } else {
            // è‹è‰² (ç»¿/èµ­/ç±³) - åƒé‡Œæ±Ÿå±±å›¾é£
            return [
                hslToHex(rand(160, 180), rand(30, 50), rand(30, 45)), // ç¥–æ¯ç»¿
                hslToHex(rand(35, 45), rand(40, 60), rand(60, 75)),   // èµ­çŸ³
                hslToHex(rand(80, 100), rand(20, 40), rand(75, 85)),  // è±†ç»¿
                hslToHex(rand(30, 45), rand(20, 40), rand(88, 95))    // ç»¢é»„
            ];
        }
    }
    // 3. å¤å¤èƒ¶ç‰‡ (Retro)
        else if (theme === 'retro') {
        const style = Math.random();
        let colors = [];

        // 1. [æ¸¯é£ç”µå½±] æµ“éƒã€æš—æ²‰ã€é«˜å¯¹æ¯” (ç‹å®¶å«é£æ ¼)
        // å…³é”®è¯ï¼šå¢¨ç»¿ã€é…’çº¢ã€æš—å¤œè“ã€é’¨ä¸ç¯é»„
        if (style < 0.4) {
            colors = [
                hslToHex(rand(340, 360), rand(40, 60), rand(20, 35)), // é…’çº¢/çŒªè‚çº¢ (æš—éƒ¨)
                hslToHex(rand(160, 180), rand(30, 50), rand(15, 30)), // æ·±å¢¨ç»¿ (èƒŒæ™¯)
                hslToHex(rand(35, 50), rand(50, 70), rand(40, 55)),   // èŠ¥æœ«é»„/æ—§ç¯æ³¡è‰²
                hslToHex(rand(200, 220), rand(20, 40), rand(30, 45))  // ä¹Ÿå°±æ˜¯è“ (èƒ¶ç‰‡æš—éƒ¨åè“)
            ];
        } 
        // 2. [æ³›é»„æ—§ç…§] æ€€æ—§ã€æ£•è¤ã€å†å²æ„Ÿ (Sepia Tone)
        // å…³é”®è¯ï¼šå’–å•¡ã€ç‰›çš®çº¸ã€ç”Ÿé”ˆã€æ²‰é¦™
        else if (style < 0.7) {
            const baseHue = rand(25, 45); // æ©™é»„åˆ°åœŸé»„åŒºé—´
            colors = [
                hslToHex(baseHue, rand(30, 50), rand(15, 25)),        // æ·±è¤/å’–å•¡
                hslToHex(baseHue + rand(-5, 5), rand(25, 45), rand(35, 50)), // çš®é©è‰²/é”ˆè‰²
                hslToHex(baseHue + rand(-5, 5), rand(20, 40), rand(60, 75)), // æ³›é»„æ—§ä¹¦é¡µ (ä¸å†æ˜¯äº®ç™½)
                hslToHex(0, 0, rand(20, 35))                          // ç‚­é»‘/æ·±ç° (å¢åŠ é¢—ç²’æ„Ÿ)
            ];
        } 
        // 3. [å†·è°ƒè¤ªè‰²] å®ä¸½æ¥ã€ä½é¥±å’Œã€ç”šè‡³æœ‰ç‚¹å¿§éƒ
        // å…³é”®è¯ï¼šé›¾éœ¾è“ã€æ°´æ³¥ç°ã€è¤ªè‰²ç²‰ã€æ¯è‰ç™½
        else {
            colors = [
                hslToHex(rand(190, 210), rand(15, 30), rand(30, 45)), // é›¾éœ¾è“
                hslToHex(rand(0, 20), rand(15, 30), rand(40, 55)),    // å¹²æ¯ç«ç‘°/è¤ªè‰²çº¢
                hslToHex(rand(160, 180), rand(10, 25), rand(30, 50)), // ç°é’è‰²
                hslToHex(40, rand(10, 30), rand(75, 85))              // éª¨è‰²/ç±³ç° (åšæ—§çš„é«˜å…‰)
            ];
        }

        // éšæœºæ‰“ä¹±é¡ºåºï¼Œè®©æ·±è‰²ä¸æ€»æ˜¯åœ¨ç¬¬ä¸€ä¸ª
        colors.sort(() => Math.random() - 0.5);
        
        return colors;
    }
        
    return ['#000000', '#333333', '#666666', '#999999'];
    }

    // UI äº¤äº’
    function generateNewPalette() {
        const themeSelect = document.getElementById('themeSelect');
        const themeValue = themeSelect.value;
        const colors = getColorsByTheme(themeValue);
        
        document.getElementById('themeTitle').innerText = themeValue;
        
        const randomNum = String(rand(1, 999)).padStart(3, '0');
        document.getElementById('serialNo').innerText = `No.${randomNum}`;

        colors.forEach((color, index) => {
            updatePoster(index + 1, color);
        });
    }

    function updatePoster(index, color) {
        if(!color.startsWith('#') && color.length === 6) color = '#' + color;
        
        document.documentElement.style.setProperty(`--c${index}`, color);

        let displayHex = color.replace('#', '').toUpperCase();
        document.getElementById(`label-${index}`).innerText = displayHex;
        document.getElementById(`p${index}`).value = color;
        document.getElementById(`t${index}`).value = color.toUpperCase();
    }

    function downloadPoster() {
        alert("æç¤ºï¼š\nPCç«¯ï¼šè¯·ç›´æ¥ä½¿ç”¨ å¾®ä¿¡æˆªå›¾ (Alt+A) æˆ– QQæˆªå›¾ã€‚\nç§»åŠ¨ç«¯ï¼šè¯·ç›´æ¥æ‰‹æœºæˆªå±ã€‚\n\nè¿™æ ·è·å–çš„å›¾ç‰‡è´¨é‡æœ€é«˜ï¼");
    }

    // å¤åˆ¶ä¸æç¤º
    function showToast(message) {
        var toast = document.getElementById("toast");
        toast.className = "show";
        toast.innerText = message;
        // æ¸…é™¤ä¹‹å‰çš„timerï¼Œé˜²æ­¢é—ªçƒ
        if(window.toastTimer) clearTimeout(window.toastTimer);
        window.toastTimer = setTimeout(function(){ toast.className = toast.className.replace("show", ""); }, 2000);
    }

    function copyFromInput(inputElement) {
        const color = inputElement.value;
        navigator.clipboard.writeText(color).then(() => {
            showToast(`é¢œè‰² ${color} å·²å¤åˆ¶`);
        });
    }

    function copyColorByIndex(index) {
        const color = document.getElementById(`t${index}`).value;
        navigator.clipboard.writeText(color).then(() => {
            showToast(`é¢œè‰² ${color} å·²å¤åˆ¶`);
        });
    }

    // æ–°å¢ï¼šå¤åˆ¶æ•´ç»„é¢œè‰²
    function copyAllHex() {
        // è·å–æ‰€æœ‰é¢œè‰²
        const c1 = document.getElementById('t1').value;
        const c2 = document.getElementById('t2').value;
        const c3 = document.getElementById('t3').value;
        const c4 = document.getElementById('t4').value;
        
        // æ ¼å¼åŒ–ä¸ºé€—å·åˆ†éš”å­—ç¬¦ä¸²
        const allColors = `${c1}, ${c2}, ${c3}, ${c4}`;
        
        navigator.clipboard.writeText(allColors).then(() => {
            showToast('æ•´ç»„é¢œè‰²å·²å¤åˆ¶');
        }).catch(err => {
            console.error('å¤åˆ¶å¤±è´¥', err);
            // å…¼å®¹æ€§æ–¹æ¡ˆ
            const textArea = document.createElement("textarea");
            textArea.value = allColors;
            document.body.appendChild(textArea);
            textArea.select();
            document.execCommand("Copy");
            textArea.remove();
            showToast('æ•´ç»„é¢œè‰²å·²å¤åˆ¶');
        });
    }

    //window.onload = generateNewPalette;

</script>

</body>
</html>
